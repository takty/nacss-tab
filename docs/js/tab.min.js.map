{"version":3,"sources":["tab.js"],"names":["window","NS","initialize","cs","opts","length","Object","assign","styleBar","styleCurrent","styleActive","hashPrefix","is","i","inst","create","push","addEventListener","forEach","onHashChanged","tar","getCurrentByHash","location","hash","active","setTimeout","update","cont","cid","vs","uls","hs","extractHeaders","noHash","bars","h","idx","bar","createBar","insertBefore","ul","elm","assignEvent","id","replace","document","getElementById","indexOf","prefix","fh","getFirstHeading","tn","tagName","Array","from","children","curH","activate","createElement","className","setClass","as","a","createAnchor","li","appendChild","onClick","fn","targets","threshold","rootMargin","fill","tm","Map","init","io","IntersectionObserver","es","e","get","target","isIntersecting","mt","t","observe","set","st","onResize","s","getComputedStyle","documentElement","val","parseInt","scrollPaddingTop","Number","isNaN","getScrollOffset","clearTimeout","disconnect","onIntersect","clicked","y","getBoundingClientRect","top","innerHeight","getFirstVisible","find","tabScroll","maxHeightRate","doRemoveHeader","resize","scrollIntoView","behavior","getAnchorPage","ps","curIdx","extractHeadersAndPages","bar0","bar1","firstChild","p","isAccordion","re","RegExp","href","match","findIndex","contains","curP","removeChild","preventDefault","parentElement","pointerEvents","url","history","pushState","scrollToTab","flexDirection","ul0","ul1","r0","bottom","r1","a0","a1","style","minHeight","minH","getMinHeight","marginBtm","marginBottom","marginTop","height","mb","Math","max","offsetHeight","tabStack","container","test","title","innerText","innerHTML","querySelectorAll","remove","spanning","c","replaceChild","cls","enabled","key","substr","startsWith","dataset","join","classList","add","resizeListeners","doFirst","isRunning","args","requestAnimationFrame","throttle","l","passive"],"mappings":"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","file":"tab.min.js","sourcesContent":["/**\n *\n * Tab\n *\n * @author Takuto Yanagida\n * @version 2021-12-07\n *\n */\n\n\n'use strict';\n\nwindow['NACSS'] = window['NACSS'] || {};\n\n\n(function (NS) {\n\n\t{\n\t\t/**\n\t\t *\n\t\t * Scroll\n\t\t *\n\t\t * @author Takuto Yanagida\n\t\t * @version 2021-11-30\n\t\t *\n\t\t */\n\t\t\n\t\t\n\t\tfunction initialize(cs, opts = {}) {\n\t\t\tif (cs.length === 0) return;\n\t\t\n\t\t\topts = Object.assign({\n\t\t\t\tstyleBar    : ':ncTabBar',\n\t\t\t\tstyleCurrent: ':ncCurrent',\n\t\t\t\tstyleActive : ':ncActive',\n\t\t\t\thashPrefix  : 'tsc:',\n\t\t\t}, opts);\n\t\t\tconst is = [];\n\t\t\tfor (let i = 0; i < cs.length; i += 1) {\n\t\t\t\tconst inst = create(cs[i], i + 1, opts);\n\t\t\t\tif (inst) is.push(inst);\n\t\t\t}\n\t\t\twindow.addEventListener('hashchange', () => is.forEach(onHashChanged));\n\t\t}\n\t\t\n\t\tfunction onHashChanged(inst) {\n\t\t\tconst tar = getCurrentByHash(inst, location.hash);\n\t\t\tinst.active = tar;\n\t\t\tsetTimeout(() => update(inst), 10);\n\t\t}\n\t\t\n\t\t\n\t\t// -------------------------------------------------------------------------\n\t\t\n\t\t\n\t\tfunction create(cont, cid, opts) {\n\t\t\tconst inst = {\n\t\t\t\topts,\n\t\t\t\tvs    : null,\n\t\t\t\tuls   : [],\n\t\t\t\tactive: null,\n\t\t\t}\n\t\t\tconst hs = extractHeaders(cont, cid, opts.hashPrefix);\n\t\t\tif (hs.length === 0) return false;\n\t\t\n\t\t\tconst noHash = location.hash.length <= 1;\n\t\t\tconst bars   = [];\n\t\t\ths.forEach((h, idx) => {\n\t\t\t\tconst bar = createBar(hs, h, opts, noHash && idx === 0);\n\t\t\t\tcont.insertBefore(bar.ul, h.elm);\n\t\t\t\tbars.push(bar);\n\t\t\t\tinst.uls.push(bar.ul);\n\t\t\t});\n\t\t\tassignEvent(inst, bars);\n\t\t\n\t\t\tinst.active = getCurrentByHash(inst, location.hash);\n\t\t\tsetTimeout(() => update(inst), 100);  // For avoiding unnecessary update\n\t\t\treturn inst;\n\t\t}\n\t\t\n\t\tfunction getCurrentByHash(inst, hash) {\n\t\t\tconst id = hash.replace('#', '');\n\t\t\tif (id !== '') {\n\t\t\t\tconst tar = document.getElementById(id);\n\t\t\t\tif (tar && inst.uls.indexOf(tar) !== 0) {\n\t\t\t\t\treturn tar;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\t\t\n\t\t\n\t\t// -------------------------------------------------------------------------\n\t\t\n\t\t\n\t\tfunction extractHeaders(cont, cid, prefix) {\n\t\t\tconst fh = getFirstHeading(cont);\n\t\t\tif (!fh) return [];\n\t\t\tconst tn = fh.tagName;\n\t\t\tconst hs = [];\n\t\t\n\t\t\tfor (const elm of Array.from(cont.children)) {\n\t\t\t\tif (elm.tagName === tn) {\n\t\t\t\t\tconst id = `${prefix}${cid}-${hs.length + 1}`;\n\t\t\t\t\ths.push({ elm, id });\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn hs;\n\t\t}\n\t\t\n\t\tfunction createBar(hs, curH, opts, activate) {\n\t\t\tconst ul = document.createElement('ul');\n\t\t\tul.id = curH.id;\n\t\t\tul.className = '';  // for Dummy\n\t\t\tsetClass(ul, opts.styleBar);\n\t\t\tif (activate) setClass(ul, opts.styleActive);\n\t\t\tconst as = [];\n\t\t\n\t\t\tfor (const h of hs) {\n\t\t\t\tconst a = createAnchor(h);\n\t\t\t\tconst li = document.createElement('li');\n\t\t\t\tif (h === curH) setClass(li, opts.styleCurrent);\n\t\t\t\tli.appendChild(a);\n\t\t\t\tul.appendChild(li);\n\t\t\t\tas.push(a);\n\t\t\t}\n\t\t\treturn { ul, as };\n\t\t}\n\t\t\n\t\t\n\t\t// -------------------------------------------------------------------------\n\t\t\n\t\t\n\t\tfunction assignEvent(inst, bars) {\n\t\t\tfor (const bar of bars) {\n\t\t\t\tbar.as.forEach((a, i) => {\n\t\t\t\t\ta.addEventListener('click', () => onClick(inst, bars[i].ul));\n\t\t\t\t});\n\t\t\t}\n\t\t\tonIntersect((vs) => {\n\t\t\t\tinst.vs = vs;\n\t\t\t\tupdate(inst);\n\t\t\t}, inst.uls, 0);\n\t\t}\n\t\t\n\t\tfunction onClick(inst, clicked) {\n\t\t\tinst.active = clicked;\n\t\t\tsetTimeout(() => {\n\t\t\t\tif (inst.active) {\n\t\t\t\t\tconst y = inst.active.getBoundingClientRect().top;\n\t\t\t\t\tinst.active = null;\n\t\t\t\t\tif (window.innerHeight < y) update(inst);\n\t\t\t\t}\n\t\t\t}, 1000);\n\t\t}\n\t\t\n\t\tfunction update(inst) {\n\t\t\tconst tar = inst.active ? inst.active : getFirstVisible(inst);\n\t\t\tfor (const ul of inst.uls) {\n\t\t\t\tsetClass(ul, inst.opts.styleActive, ul === tar);\n\t\t\t}\n\t\t}\n\t\t\n\t\tfunction getFirstVisible(inst) {\n\t\t\tif (!inst.vs) return null;\n\t\t\treturn inst.uls.find((ul, i) => inst.vs[i]);\n\t\t}\n\t\t\n\t\tNS.tabScroll = initialize;\n\t}\n\n\t{\n\t\t/**\n\t\t *\n\t\t * Stack\n\t\t *\n\t\t * @author Takuto Yanagida\n\t\t * @version 2021-10-23\n\t\t *\n\t\t */\n\t\t\n\t\t\n\t\tfunction initialize(cs, opts = {}) {\n\t\t\tif (cs.length === 0) return;\n\t\t\n\t\t\topts = Object.assign({\n\t\t\t\tstyleBar      : ':ncTabBar',\n\t\t\t\tstyleCurrent  : ':ncCurrent',\n\t\t\t\tstyleActive   : ':ncActive',\n\t\t\t\thashPrefix    : 'tst:',\n\t\t\t\tmaxHeightRate : 0.8,\n\t\t\t\tdoRemoveHeader: false,\n\t\t\t}, opts);\n\t\t\tconst is = [];\n\t\t\tfor (let i = 0; i < cs.length; i += 1) {\n\t\t\t\tconst inst = create(cs[i], i + 1, opts);\n\t\t\t\tif (inst) is.push(inst);\n\t\t\t}\n\t\t\tonResize(() => is.forEach(resize), true);\n\t\t\twindow.addEventListener('hashchange', () => is.forEach(onHashChanged) );\n\t\t\n\t\t\tsetTimeout(() => {\n\t\t\t\tconst id = location.hash.replace('#', '');\n\t\t\t\tif (id !== '') {\n\t\t\t\t\tconst tar = document.getElementById(id);\n\t\t\t\t\tif (tar) tar.scrollIntoView({ behavior: 'smooth' });\n\t\t\t\t}\n\t\t\t}, 10);\n\t\t}\n\t\t\n\t\tfunction onHashChanged(inst) {\n\t\t\tlet idx = getCurrentByHash(inst, location.hash);\n\t\t\tif (idx === null) idx = getAnchorPage(inst, location.hash);\n\t\t\tif (idx !== null) setTimeout(() => update(inst, idx), 10);\n\t\t}\n\t\t\n\t\t\n\t\t// -------------------------------------------------------------------------\n\t\t\n\t\t\n\t\tfunction create(cont, cid, opts) {\n\t\t\tconst inst = {\n\t\t\t\topts,\n\t\t\t\tcont,\n\t\t\t\tps    : null,\n\t\t\t\tbars  : [],\n\t\t\t\tcurIdx: 0,\n\t\t\t};\n\t\t\tconst [hs, ps] = extractHeadersAndPages(cont, cid, opts);\n\t\t\tif (hs.length === 0) return false;\n\t\t\tinst.ps = ps;\n\t\t\n\t\t\tconst bar0 = createBar(hs, opts);\n\t\t\tconst bar1 = createBar(hs, opts);\n\t\t\tinst.bars.push(bar0, bar1);\n\t\t\n\t\t\tcont.insertBefore(bar0.ul, cont.firstChild);\n\t\t\tfor (const p of ps) cont.appendChild(p);\n\t\t\tcont.appendChild(bar1.ul);\n\t\t\n\t\t\tassignEvent(inst);\n\t\t\n\t\t\tconst h = location.hash;\n\t\t\tlet idx = getCurrentByHash(inst, h);\n\t\t\tif (idx === null) idx = getAnchorPage(inst, h);\n\t\t\tif (idx === null) idx = isAccordion(inst) ? -1 : 0;\n\t\t\tsetTimeout(() => update(inst, idx), 10);\n\t\t\treturn inst;\n\t\t}\n\t\t\n\t\tfunction getCurrentByHash(inst, hash) {\n\t\t\tif (hash.indexOf('#') === -1) return null;\n\t\t\tconst re = new RegExp(hash + '$', 'g');\n\t\t\tconst as = inst.bars[0].as;\n\t\t\tfor (let i = 0; i < as.length; i += 1) {\n\t\t\t\tif (as[i].href.match(re)) return i;\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\t\t\n\t\tfunction getAnchorPage(inst, hash) {\n\t\t\tconst id = hash.replace('#', '');\n\t\t\tif (id !== '') {\n\t\t\t\tconst tar = document.getElementById(id);\n\t\t\t\tif (tar) {\n\t\t\t\t\tconst idx = inst.ps.findIndex(p => p.contains(tar));\n\t\t\t\t\tif (idx !== -1) return idx;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\t\t\n\t\t\n\t\t// -------------------------------------------------------------------------\n\t\t\n\t\t\n\t\tfunction extractHeadersAndPages(cont, cid, opts) {\n\t\t\tconst fh = getFirstHeading(cont);\n\t\t\tif (!fh) return [];\n\t\t\tconst tn = fh.tagName;\n\t\t\tconst hs = [];\n\t\t\tconst ps = [];\n\t\t\tlet curP = null;\n\t\t\n\t\t\tfor (const elm of Array.from(cont.children)) {\n\t\t\t\tif (elm.tagName === tn) {\n\t\t\t\t\tconst id = `${opts.hashPrefix}${cid}-${hs.length + 1}`;\n\t\t\t\t\ths.push({ elm, id });\n\t\t\n\t\t\t\t\tif (curP) ps.push(curP);\n\t\t\t\t\tcurP = document.createElement('div');\n\t\t\t\t\tif (opts.doRemoveHeader) {\n\t\t\t\t\t\tcont.removeChild(elm);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcurP.appendChild(elm);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (curP) curP.appendChild(elm);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (curP) ps.push(curP);\n\t\t\treturn [hs, ps];\n\t\t}\n\t\t\n\t\tfunction createBar(hs, opts) {\n\t\t\tconst ul = document.createElement('ul');\n\t\t\tul.className = '';  // for Dummy\n\t\t\tsetClass(ul, opts.styleBar);\n\t\t\tconst as = [];\n\t\t\n\t\t\tfor (const h of hs) {\n\t\t\t\tconst a = createAnchor(h);\n\t\t\t\tconst li = document.createElement('li');\n\t\t\t\tli.appendChild(a);\n\t\t\t\tul.appendChild(li);\n\t\t\t\tas.push(a);\n\t\t\t}\n\t\t\treturn { ul, as };\n\t\t}\n\t\t\n\t\t\n\t\t// -------------------------------------------------------------------------\n\t\t\n\t\t\n\t\tfunction assignEvent(inst) {\n\t\t\tfor (const bar of inst.bars) {\n\t\t\t\tbar.as.forEach((a, i) => {\n\t\t\t\t\ta.addEventListener('click', (e) => onClick(e, inst, i));\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\t\n\t\tfunction onClick(e, inst, idx) {\n\t\t\te.preventDefault();\n\t\t\tif (getComputedStyle(e.target.parentElement).pointerEvents === 'none') return;\n\t\t\tlet url = e.target.href;\n\t\t\tif (inst.curIdx === idx) {\n\t\t\t\tidx = -1;\n\t\t\t\turl = url.replace(/#.*$/, '');\n\t\t\t}\n\t\t\thistory.pushState({}, null, url);\n\t\t\tupdate(inst, idx);\n\t\t\tscrollToTab(inst);\n\t\t}\n\t\t\n\t\tfunction isAccordion(inst) {\n\t\t\treturn getComputedStyle(inst.bars[0].ul).flexDirection === 'column';\n\t\t}\n\t\t\n\t\tfunction scrollToTab(inst) {\n\t\t\tif (inst.curIdx === -1) return;\n\t\t\tsetTimeout(() => {\n\t\t\t\tconst [{ ul: ul0 }, { ul: ul1 }] = inst.bars;\n\t\t\t\tconst r0 = ul0.getBoundingClientRect();\n\t\t\t\tif (0 <= r0.top && r0.top <= window.innerHeight && 0 <= r0.bottom && r0.bottom <= window.innerHeight) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst r1 = ul1.getBoundingClientRect();\n\t\t\t\tif (isAccordion(inst) || (r1.top < 0 || window.innerHeight < r1.bottom)) {\n\t\t\t\t\tinst.cont.scrollIntoView({ behavior: 'smooth' });\n\t\t\t\t}\n\t\t\t}, 10);\n\t\t}\n\t\t\n\t\tfunction update(inst, idx) {\n\t\t\tconst ps = inst.ps;\n\t\t\tconst [{ as: a0 }, { as: a1 }] = inst.bars;\n\t\t\n\t\t\tfor (let i = 0; i < ps.length; i += 1) {\n\t\t\t\tsetClass(a0[i].parentElement, inst.opts.styleCurrent, i === idx);\n\t\t\t\tsetClass(a1[i].parentElement, inst.opts.styleCurrent, i === idx);\n\t\t\t\tsetClass(ps[i], inst.opts.styleCurrent, i === idx);\n\t\t\t}\n\t\t\tinst.curIdx = idx;\n\t\t}\n\t\t\n\t\t\n\t\t// -------------------------------------------------------------------------\n\t\t\n\t\t\n\t\tfunction resize(inst) {\n\t\t\tconst cont = inst.cont;\n\t\t\tif (isAccordion(inst)) {\n\t\t\t\tcont.style.minHeight = '';\n\t\t\t} else {\n\t\t\t\tconst minH = getMinHeight(inst);\n\t\t\t\tconst h = (minH < window.innerHeight * inst.opts.maxHeightRate) ? `${minH}px` : '';\n\t\t\t\tcont.style.minHeight = h;\n\t\t\n\t\t\t\tif (inst.curIdx === -1) {\n\t\t\t\t\tupdate(inst, 0);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tfunction getMinHeight(inst) {\n\t\t\tconst [{ ul: ul0 }, { ul: ul1 }] = inst.bars;\n\t\t\n\t\t\tlet marginBtm = parseInt(getComputedStyle(ul0).marginBottom);\n\t\t\tlet marginTop = parseInt(getComputedStyle(ul1).marginTop);\n\t\t\tlet height = 0;\n\t\t\n\t\t\tfor (const p of inst.ps) {\n\t\t\t\tconst ps = getComputedStyle(p);\n\t\t\t\tconst mt = parseInt(ps.marginTop);\n\t\t\t\tconst mb = parseInt(ps.marginBottom);\n\t\t\t\tconst h  = p.getBoundingClientRect().height;\n\t\t\n\t\t\t\tmarginBtm = Math.max(marginBtm, mt);\n\t\t\t\tmarginTop = Math.max(marginTop, mb);\n\t\t\t\theight    = Math.max(height, h);\n\t\t\t}\n\t\t\treturn ul0.offsetHeight + ul1.offsetHeight + marginBtm + marginTop + height;\n\t\t}\n\t\t\n\t\tNS.tabStack = initialize;\n\t}\n\n\t/**\n\t *\n\t * Common Functions\n\t *\n\t * @author Takuto Yanagida\n\t * @version 2021-10-23\n\t *\n\t */\n\t\n\t\n\tfunction getFirstHeading(container) {\n\t\tconst cs = container.children;\n\t\tfor (let i = 0; i < cs.length; i += 1) {\n\t\t\tif (/^H[1-6]$/.test(cs[i].tagName)) return cs[i];\n\t\t}\n\t\treturn null;\n\t}\n\t\n\tfunction createAnchor(h) {\n\t\tconst a = document.createElement('a');\n\t\ta.href  = '#' + h.id;\n\t\ta.title = h.elm.innerText;\n\t\tconst t = h.elm.title ? h.elm.title : h.elm.innerHTML;\n\t\n\t\ta.innerHTML = t;\n\t\ta.querySelectorAll('small').forEach(e => e.remove());\n\t\tif (a.innerText === '') {\n\t\t\ta.innerHTML = t;\n\t\t}\n\t\tspanning(a);\n\t\treturn a;\n\t}\n\t\n\tfunction spanning(e) {\n\t\tfor (const c of Array.from(e.children)) {\n\t\t\tif (c.tagName === 'A' || c.tagName === 'SMALL') {\n\t\t\t\tconst s = document.createElement('span');\n\t\t\t\ts.innerHTML = c.innerHTML;\n\t\t\t\te.replaceChild(s, c);\n\t\t\t\tspanning(s);\n\t\t\t} else {\n\t\t\t\tspanning(c);\n\t\t\t}\n\t\t}\n\t}\n\t\n\t/**\n\t *\n\t * Style Class Utilities\n\t *\n\t * @author Takuto Yanagida\n\t * @version 2021-11-11\n\t *\n\t */\n\t\n\t\n\tfunction hasClass(tar, cls) {\n\t\tconst key = cls.substr(1);\n\t\tif (cls.startsWith(':')) {\n\t\t\treturn tar.dataset[key] !== undefined;\n\t\t} else {\n\t\t\treturn tar.classList.contains(key);\n\t\t}\n\t}\n\t\n\tfunction setClass(tar, cls, enabled = true, val = '') {\n\t\tconst key = cls.substr(1);\n\t\tif (cls.startsWith(':')) {\n\t\t\tif (enabled) {\n\t\t\t\ttar.dataset[key] = val;\n\t\t\t} else {\n\t\t\t\tdelete tar.dataset[key];\n\t\t\t}\n\t\t} else {\n\t\t\tconst c = [key, val].join('-');\n\t\t\tif (enabled) {\n\t\t\t\ttar.classList.add(c);\n\t\t\t} else {\n\t\t\t\ttar.classList.remove(c);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tfunction getSelector(cls) {\n\t\tif (cls.startsWith(':')) {\n\t\t\treturn `*[data-${cls.substr(1).replace(/([A-Z])/g, c => '-' + c.charAt(0).toLowerCase())}]`;\n\t\t} else {\n\t\t\treturn `*${cls}`;\n\t\t}\n\t}\n\t\n\t/**\n\t *\n\t * Utilities\n\t *\n\t * @author Takuto Yanagida\n\t * @version 2021-12-06\n\t *\n\t */\n\t\n\t\n\tfunction getScrollOffset() {\n\t\tconst s   = getComputedStyle(document.documentElement);\n\t\tconst val = parseInt(s.scrollPaddingTop);\n\t\treturn Number.isNaN(val) ? 0 : val;\n\t}\n\t\n\t\n\t// -----------------------------------------------------------------------------\n\t\n\t\n\tfunction throttle(fn) {\n\t\tlet isRunning;\n\t\treturn (...args) => {\n\t\t\tif (isRunning) return;\n\t\t\tisRunning = true;\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tisRunning = false;\n\t\t\t\tfn(...args);\n\t\t\t});\n\t\t};\n\t}\n\t\n\tconst resizeListeners = [];\n\t\n\tfunction onResize(fn, doFirst = false) {\n\t\tif (doFirst) fn();\n\t\tresizeListeners.push(throttle(fn));\n\t}\n\t\n\tdocument.addEventListener('DOMContentLoaded', () => {\n\t\twindow.addEventListener('resize', () => {\n\t\t\tfor (const l of resizeListeners) l();\n\t\t}, { passive: true });\n\t});\n\t\n\t\n\t// -----------------------------------------------------------------------------\n\t\n\t\n\tfunction onIntersect(fn, targets, threshold = 0, rootMargin = '* 0px 0px 0px') {\n\t\tconst vs = Array(targets.length).fill(false);\n\t\tconst tm = new Map();\n\t\ttargets.forEach((t, i) => tm.set(t, i));\n\t\n\t\tfunction init() {\n\t\t\tconst io = new IntersectionObserver((es) => {\n\t\t\t\tfor (const e of es) vs[tm.get(e.target)] = e.isIntersecting;\n\t\t\t\tfn(vs);\n\t\t\t}, { rootMargin: rootMargin.replace('*', `${mt}px`), threshold });\n\t\t\tfor (const t of targets) io.observe(t);\n\t\t\treturn io;\n\t\t}\n\t\tlet mt = 0;\n\t\tlet io = null;\n\t\tlet st = null;\n\t\tonResize(() => {\n\t\t\tmt = -getScrollOffset();\n\t\t\tif (st) clearTimeout(st);\n\t\t\tst = setTimeout(() => {\n\t\t\t\tif (io) io.disconnect();\n\t\t\t\tio = init();\n\t\t\t}, 100);\n\t\t}, true);\n\t}\n\t\n\n})(window['NACSS']);\n"]}