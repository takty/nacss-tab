{"version":3,"sources":["tab.js"],"names":["window","NS","getFirstHeading","container","cs","children","i","length","test","tagName","createAnchor","h","a","document","createElement","href","id","title","elm","innerText","t","innerHTML","querySelectorAll","forEach","e","remove","spanning","c","Array","from","s","replaceChild","enableClass","enabled","tar","cls","key","substr","startsWith","dataset","classList","add","create","cont","cid","opts","inst","vs","uls","active","hs","prefix","fh","tn","push","extractHeaders","hashPrefix","bars","bar","createBar","insertBefore","ul","as","addEventListener","onClick","fn","doFirst","os","ts","init","r","rootMargin","mt","marginRight","marginBottom","marginLeft","io","IntersectionObserver","es","prevVs","indexOf","target","isIntersecting","vs0","vs1","isMatch","threshold","observe","fill","marginTop","st","onResize","clearTimeout","setTimeout","disconnect","observeIntersection","concat","onIntersect","update","targets","location","hash","replace","getElementById","assignEvent","curH","className","styleBar","li","styleCurrent","appendChild","clicked","y","getBoundingClientRect","top","innerHeight","find","getFirstVisible","styleActive","tabScroll","Object","assign","onHashChanged","idx","getCurrentPage","getAnchorPage","ps","curIdx","curP","doRemoveHeader","removeChild","extractHeadersAndPages","bar0","bar1","firstChild","p","isAccordion","preventDefault","getComputedStyle","parentElement","pointerEvents","url","history","pushState","ul0","ul1","r0","bottom","r1","scrollIntoView","behavior","scrollToTab","flexDirection","re","RegExp","match","contains","a0","a1","resize","style","minHeight","minH","marginBtm","parseInt","height","mb","Math","max","offsetHeight","getMinHeight","maxHeightRate","tabStack","is","resizeListeners","isRunning","args","requestAnimationFrame","throttle","l","passive"],"mappings":"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","file":"tab.min.js","sourcesContent":["/**\n *\n * Tab Style (JS)\n *\n * @author Takuto Yanagida\n * @version 2021-10-19\n *\n */\n\n\nwindow['NACSS'] = window['NACSS'] || {};\n\n\n(function (NS) {\n\n\t(function () {\n\t\t/**\n\t\t *\n\t\t * Tab - Scroll (JS)\n\t\t *\n\t\t * @author Takuto Yanagida\n\t\t * @version 2021-10-22\n\t\t *\n\t\t */\n\t\t\n\t\t\n\t\tfunction initialize(cs, opts = {}) {\n\t\t\tif (cs.length === 0) return;\n\t\t\n\t\t\topts = Object.assign({\n\t\t\t\tstyleBar    : ':ncTabBar',\n\t\t\t\tstyleCurrent: ':ncCurrent',\n\t\t\t\tstyleActive : ':ncActive',\n\t\t\t\thashPrefix  : 'tsc:',\n\t\t\t}, opts);\n\t\t\tfor (let i = 0; i < cs.length; i += 1) {\n\t\t\t\tcreate(cs[i], i + 1, opts);\n\t\t\t}\n\t\t}\n\t\t\n\t\tfunction create(cont, cid, opts) {\n\t\t\tconst inst = {\n\t\t\t\topts,\n\t\t\t\tvs    : null,\n\t\t\t\tuls   : [],\n\t\t\t\tactive: null,\n\t\t\t}\n\t\t\tconst hs = extractHeaders(cont, cid, opts.hashPrefix);\n\t\t\tif (hs.length === 0) return false;\n\t\t\n\t\t\tconst bars = [];\n\t\t\tfor (const h of hs) {\n\t\t\t\tconst bar = createBar(hs, h, opts);\n\t\t\t\tcont.insertBefore(bar.ul, h.elm);\n\t\t\t\tbars.push(bar);\n\t\t\t\tinst.uls.push(bar.ul);\n\t\t\t}\n\t\t\tassignEvent(inst, bars);\n\t\t}\n\t\t\n\t\t\n\t\t// -------------------------------------------------------------------------\n\t\t\n\t\t\n\t\tfunction extractHeaders(cont, cid, prefix) {\n\t\t\tconst fh = getFirstHeading(cont);\n\t\t\tif (!fh) return [];\n\t\t\tconst tn = fh.tagName;\n\t\t\tconst hs = [];\n\t\t\n\t\t\tfor (const elm of Array.from(cont.children)) {\n\t\t\t\tif (elm.tagName === tn) {\n\t\t\t\t\tconst id = `${prefix}${cid}-${hs.length + 1}`;\n\t\t\t\t\ths.push({ elm, id });\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn hs;\n\t\t}\n\t\t\n\t\tfunction createBar(hs, curH, opts) {\n\t\t\tconst ul = document.createElement('ul');\n\t\t\tul.id = curH.id;\n\t\t\tul.className = '';  // for Dummy\n\t\t\tenableClass(true, ul, opts.styleBar);\n\t\t\tconst as = [];\n\t\t\n\t\t\tfor (const h of hs) {\n\t\t\t\tconst a = createAnchor(h);\n\t\t\t\tconst li = document.createElement('li');\n\t\t\t\tif (h === curH) enableClass(true, li, opts.styleCurrent);\n\t\t\t\tli.appendChild(a);\n\t\t\t\tul.appendChild(li);\n\t\t\t\tas.push(a);\n\t\t\t}\n\t\t\treturn { ul, as };\n\t\t}\n\t\t\n\t\t\n\t\t// -------------------------------------------------------------------------\n\t\t\n\t\t\n\t\tfunction assignEvent(inst, bars) {\n\t\t\tfor (const bar of bars) {\n\t\t\t\tbar.as.forEach((a, i) => {\n\t\t\t\t\ta.addEventListener('click', () => onClick(inst, bars[i].ul));\n\t\t\t\t});\n\t\t\t}\n\t\t\tonIntersect((vs) => {\n\t\t\t\tinst.vs = vs;\n\t\t\t\tupdate(inst);\n\t\t\t}, true, { targets: inst.uls, marginTop: 'OFFSET', threshold: 0 });\n\t\t\n\t\t\tconst h = location.hash;\n\t\t\tif (h.indexOf('#') !== -1) {\n\t\t\t\tconst id = h.replace('#', '');\n\t\t\t\tif (!id) return;\n\t\t\t\tconst tar = document.getElementById(id);\n\t\t\t\tif (inst.uls.indexOf(tar) !== 0) {\n\t\t\t\t\tinst.active = tar;\n\t\t\t\t}\n\t\t\t}\n\t\t\tsetTimeout(() => update(inst), 10);\n\t\t}\n\t\t\n\t\tfunction onClick(inst, clicked) {\n\t\t\tinst.active = clicked;\n\t\t\tsetTimeout(() => update(inst), 10);\n\t\t\tsetTimeout(() => {\n\t\t\t\tif (inst.active) {\n\t\t\t\t\tconst y = inst.active.getBoundingClientRect().top;\n\t\t\t\t\tinst.active = null;\n\t\t\t\t\tif (window.innerHeight < y) update(inst);\n\t\t\t\t}\n\t\t\t}, 1000);\n\t\t}\n\t\t\n\t\tfunction update(inst) {\n\t\t\tconst tar = inst.active ? inst.active : getFirstVisible(inst);\n\t\t\tfor (const ul of inst.uls) {\n\t\t\t\tenableClass(ul === tar, ul, inst.opts.styleActive);\n\t\t\t}\n\t\t}\n\t\t\n\t\tfunction getFirstVisible(inst) {\n\t\t\tif (!inst.vs) return null;\n\t\t\treturn inst.uls.find((ul, i) => inst.vs[i]);\n\t\t}\n\t\t\n\t\tNS.tabScroll = initialize;\n\t})();\n\n\t(function () {\n\t\t/**\n\t\t *\n\t\t * Tab - Stack (JS)\n\t\t *\n\t\t * @author Takuto Yanagida\n\t\t * @version 2021-10-22\n\t\t *\n\t\t */\n\t\t\n\t\t\n\t\tfunction initialize(cs, opts = {}) {\n\t\t\tif (cs.length === 0) return;\n\t\t\n\t\t\topts = Object.assign({\n\t\t\t\tstyleBar      : ':ncTabBar',\n\t\t\t\tstyleCurrent  : ':ncCurrent',\n\t\t\t\tstyleActive   : ':ncActive',\n\t\t\t\thashPrefix    : 'tst:',\n\t\t\t\tmaxHeightRate : 0.8,\n\t\t\t\tdoRemoveHeader: false,\n\t\t\t}, opts);\n\t\t\tconst is = [];\n\t\t\tfor (let i = 0; i < cs.length; i += 1) {\n\t\t\t\tconst inst = create(cs[i], i + 1, opts);\n\t\t\t\tif (inst) is.push(inst);\n\t\t\t}\n\t\t\tonResize(() => is.forEach(resize), true);\n\t\t\twindow.addEventListener('hashchange', () => is.forEach(onHashChanged) );\n\t\t}\n\t\t\n\t\tfunction onHashChanged(inst) {\n\t\t\tlet idx = getCurrentPage(inst, location.hash);\n\t\t\tif (idx === null) idx = getAnchorPage(inst, location.hash);\n\t\t\tif (idx !== null) setTimeout(() => update(inst, idx), 10);\n\t\t}\n\t\t\n\t\tfunction create(cont, cid, opts) {\n\t\t\tconst inst = {\n\t\t\t\topts,\n\t\t\t\tcont,\n\t\t\t\tps    : null,\n\t\t\t\tbars  : [],\n\t\t\t\tcurIdx: 0,\n\t\t\t};\n\t\t\tconst [hs, ps] = extractHeadersAndPages(cont, cid, opts);\n\t\t\tif (hs.length === 0) return false;\n\t\t\tinst.ps = ps;\n\t\t\n\t\t\tconst bar0 = createBar(hs, opts);\n\t\t\tconst bar1 = createBar(hs, opts);\n\t\t\tinst.bars.push(bar0, bar1);\n\t\t\n\t\t\tcont.insertBefore(bar0.ul, cont.firstChild);\n\t\t\tfor (const p of ps) cont.appendChild(p);\n\t\t\tcont.appendChild(bar1.ul);\n\t\t\n\t\t\tassignEvent(inst);\n\t\t\treturn inst;\n\t\t}\n\t\t\n\t\t\n\t\t// -------------------------------------------------------------------------\n\t\t\n\t\t\n\t\tfunction extractHeadersAndPages(cont, cid, opts) {\n\t\t\tconst fh = getFirstHeading(cont);\n\t\t\tif (!fh) return [];\n\t\t\tconst tn = fh.tagName;\n\t\t\tconst hs = [];\n\t\t\tconst ps = [];\n\t\t\tlet curP = null;\n\t\t\n\t\t\tfor (const elm of Array.from(cont.children)) {\n\t\t\t\tif (elm.tagName === tn) {\n\t\t\t\t\tconst id = `${opts.hashPrefix}${cid}-${hs.length + 1}`;\n\t\t\t\t\ths.push({ elm, id });\n\t\t\n\t\t\t\t\tif (curP) ps.push(curP);\n\t\t\t\t\tcurP = document.createElement('div');\n\t\t\t\t\tif (opts.doRemoveHeader) {\n\t\t\t\t\t\tcont.removeChild(elm);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcurP.appendChild(elm);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (curP) curP.appendChild(elm);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (curP) ps.push(curP);\n\t\t\treturn [hs, ps];\n\t\t}\n\t\t\n\t\tfunction createBar(hs, opts) {\n\t\t\tconst ul = document.createElement('ul');\n\t\t\tul.className = '';  // for Dummy\n\t\t\tenableClass(true, ul, opts.styleBar);\n\t\t\tconst as = [];\n\t\t\n\t\t\tfor (const h of hs) {\n\t\t\t\tconst a = createAnchor(h);\n\t\t\t\tconst li = document.createElement('li');\n\t\t\t\tli.appendChild(a);\n\t\t\t\tul.appendChild(li);\n\t\t\t\tas.push(a);\n\t\t\t}\n\t\t\treturn { ul, as };\n\t\t}\n\t\t\n\t\t\n\t\t// -------------------------------------------------------------------------\n\t\t\n\t\t\n\t\tfunction assignEvent(inst) {\n\t\t\tfor (const bar of inst.bars) {\n\t\t\t\tbar.as.forEach((a, i) => {\n\t\t\t\t\ta.addEventListener('click', (e) => onClick(e, inst, i));\n\t\t\t\t});\n\t\t\t}\n\t\t\tconst h = location.hash;\n\t\t\tlet idx = getCurrentPage(inst, h);\n\t\t\tif (idx === null) idx = getAnchorPage(inst, h);\n\t\t\tif (idx === null) idx = isAccordion(inst) ? -1 : 0;\n\t\t\tsetTimeout(() => update(inst, idx), 10);\n\t\t}\n\t\t\n\t\tfunction onClick(e, inst, idx) {\n\t\t\te.preventDefault();\n\t\t\tif (getComputedStyle(e.target.parentElement).pointerEvents === 'none') return;\n\t\t\tlet url = e.target.href;\n\t\t\tif (inst.curIdx === idx) {\n\t\t\t\tidx = -1;\n\t\t\t\turl = url.replace(/#.*$/, '');\n\t\t\t}\n\t\t\thistory.pushState({}, null, url);\n\t\t\tupdate(inst, idx);\n\t\t\tscrollToTab(inst);\n\t\t}\n\t\t\n\t\tfunction isAccordion(inst) {\n\t\t\treturn getComputedStyle(inst.bars[0].ul).flexDirection === 'column';\n\t\t}\n\t\t\n\t\tfunction scrollToTab(inst) {\n\t\t\tif (inst.curIdx === -1) return;\n\t\t\tsetTimeout(() => {\n\t\t\t\tconst [{ ul: ul0 }, { ul: ul1 }] = inst.bars;\n\t\t\t\tconst r0 = ul0.getBoundingClientRect();\n\t\t\t\tif (0 <= r0.top && r0.top <= window.innerHeight && 0 <= r0.bottom && r0.bottom <= window.innerHeight) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst r1 = ul1.getBoundingClientRect();\n\t\t\t\tif (isAccordion(inst) || (r1.top < 0 || window.innerHeight < r1.bottom)) {\n\t\t\t\t\tinst.cont.scrollIntoView({ behavior: 'smooth' });\n\t\t\t\t}\n\t\t\t}, 10);\n\t\t}\n\t\t\n\t\t\n\t\t// -------------------------------------------------------------------------\n\t\t\n\t\t\n\t\tfunction getCurrentPage(inst, hash) {\n\t\t\tif (hash.indexOf('#') === -1) return null;\n\t\t\tconst re = new RegExp(hash + '$', 'g');\n\t\t\tconst as = inst.bars[0].as;\n\t\t\tfor (let i = 0; i < as.length; i += 1) {\n\t\t\t\tif (as[i].href.match(re)) return i;\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\t\t\n\t\tfunction getAnchorPage(inst, hash) {\n\t\t\tconst id = hash.replace('#', '');\n\t\t\tconst tar = document.getElementById(id);\n\t\t\tif (!tar) return null;\n\t\t\tfor (let i = 0; i < inst.ps.length; i += 1) {\n\t\t\t\tif (inst.ps[i].contains(tar)) {\n\t\t\t\t\treturn i;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\t\t\n\t\t\n\t\t// -------------------------------------------------------------------------\n\t\t\n\t\t\n\t\tfunction update(inst, idx) {\n\t\t\tconst ps = inst.ps;\n\t\t\tconst [{ as: a0 }, { as: a1 }] = inst.bars;\n\t\t\n\t\t\tfor (let i = 0; i < ps.length; i += 1) {\n\t\t\t\tenableClass(i === idx, a0[i].parentElement, inst.opts.styleCurrent);\n\t\t\t\tenableClass(i === idx, a1[i].parentElement, inst.opts.styleCurrent);\n\t\t\t\tenableClass(i === idx, ps[i], inst.opts.styleCurrent);\n\t\t\t}\n\t\t\tinst.curIdx = idx;\n\t\t}\n\t\t\n\t\t\n\t\t// -------------------------------------------------------------------------\n\t\t\n\t\t\n\t\tfunction resize(inst) {\n\t\t\tconst cont = inst.cont;\n\t\t\tif (isAccordion(inst)) {\n\t\t\t\tcont.style.minHeight = '';\n\t\t\t} else {\n\t\t\t\tconst minH = getMinHeight(inst);\n\t\t\t\tconst h = (minH < window.innerHeight * inst.opts.maxHeightRate) ? `${minH}px` : '';\n\t\t\t\tcont.style.minHeight = h;\n\t\t\n\t\t\t\tif (inst.curIdx === -1) {\n\t\t\t\t\tupdate(inst, 0);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tfunction getMinHeight(inst) {\n\t\t\tconst [{ ul: ul0 }, { ul: ul1 }] = inst.bars;\n\t\t\n\t\t\tlet marginBtm = parseInt(getComputedStyle(ul0).marginBottom);\n\t\t\tlet marginTop = parseInt(getComputedStyle(ul1).marginTop);\n\t\t\tlet height = 0;\n\t\t\n\t\t\tfor (const p of inst.ps) {\n\t\t\t\tconst ps = getComputedStyle(p);\n\t\t\t\tconst mt = parseInt(ps.marginTop);\n\t\t\t\tconst mb = parseInt(ps.marginBottom);\n\t\t\t\tconst h  = p.getBoundingClientRect().height;\n\t\t\n\t\t\t\tmarginBtm = Math.max(marginBtm, mt);\n\t\t\t\tmarginTop = Math.max(marginTop, mb);\n\t\t\t\theight    = Math.max(height, h);\n\t\t\t}\n\t\t\treturn ul0.offsetHeight + ul1.offsetHeight + marginBtm + marginTop + height;\n\t\t}\n\t\t\n\t\tNS.tabStack = initialize;\n\t})();\n\n\t/**\n\t *\n\t * Common Functions\n\t *\n\t * @author Takuto Yanagida\n\t * @version 2021-10-23\n\t *\n\t */\n\t\n\t\n\tfunction getFirstHeading(container) {\n\t\tconst cs = container.children;\n\t\tfor (let i = 0; i < cs.length; i += 1) {\n\t\t\tif (/^H[1-6]$/.test(cs[i].tagName)) return cs[i];\n\t\t}\n\t\treturn null;\n\t}\n\t\n\tfunction createAnchor(h) {\n\t\tconst a = document.createElement('a');\n\t\ta.href  = '#' + h.id;\n\t\ta.title = h.elm.innerText;\n\t\tconst t = h.elm.title ? h.elm.title : h.elm.innerHTML;\n\t\n\t\ta.innerHTML = t;\n\t\ta.querySelectorAll('small').forEach(e => e.remove());\n\t\tif (a.innerText === '') {\n\t\t\ta.innerHTML = t;\n\t\t}\n\t\tspanning(a);\n\t\treturn a;\n\t}\n\t\n\tfunction spanning(e) {\n\t\tfor (const c of Array.from(e.children)) {\n\t\t\tif (c.tagName === 'A' || c.tagName === 'SMALL') {\n\t\t\t\tconst s = document.createElement('span');\n\t\t\t\ts.innerHTML = c.innerHTML;\n\t\t\t\te.replaceChild(s, c);\n\t\t\t\tspanning(s);\n\t\t\t} else {\n\t\t\t\tspanning(c);\n\t\t\t}\n\t\t}\n\t}\n\t\n\t/**\n\t *\n\t * Utilities\n\t *\n\t * @author Takuto Yanagida\n\t * @version 2021-10-21\n\t *\n\t */\n\t\n\t\n\tfunction enableClass(enabled, tar, cls) {\n\t\tconst key = cls.substr(1);\n\t\tif (cls.startsWith(':')) {\n\t\t\tif (enabled) {\n\t\t\t\ttar.dataset[key] = '';\n\t\t\t} else {\n\t\t\t\tdelete tar.dataset[key];\n\t\t\t}\n\t\t} else {\n\t\t\tif (enabled) {\n\t\t\t\ttar.classList.add(key);\n\t\t\t} else {\n\t\t\t\ttar.classList.remove(key);\n\t\t\t}\n\t\n\t\t}\n\t}\n\t\n\tfunction throttle(fn) {\n\t\tlet isRunning;\n\t\treturn (...args) => {\n\t\t\tif (isRunning) return;\n\t\t\tisRunning = true;\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tisRunning = false;\n\t\t\t\tfn(...args);\n\t\t\t});\n\t\t};\n\t}\n\t\n\tconst resizeListeners = [];\n\t\n\tfunction onResize(fn, doFirst = false) {\n\t\tif (doFirst) fn();\n\t\tresizeListeners.push(throttle(fn));\n\t}\n\t\n\tdocument.addEventListener('DOMContentLoaded', () => {\n\t\twindow.addEventListener('resize', () => {\n\t\t\tfor (const l of resizeListeners) l();\n\t\t}, { passive: true });\n\t});\n\t\n\tfunction onIntersect(fn, doFirst = false, opts = {}) {\n\t\t// if (doFirst) fn();\n\t\topts['targets']      = opts['targets']      ?? [];\n\t\topts['marginTop']    = opts['marginTop']    ?? 0;\n\t\topts['marginLeft']   = opts['marginLeft']   ?? 0;\n\t\topts['marginRight']  = opts['marginRight']  ?? 0;\n\t\topts['marginBottom'] = opts['marginBottom'] ?? 0;\n\t\topts['threshold']    = opts['threshold']    ?? 1;\n\t\n\t\tobserveIntersection(fn, opts, opts['targets'].concat());\n\t}\n\t\n\tfunction observeIntersection(fn, os, ts) {\n\t\tfunction init() {\n\t\t\t// for workaround of rootMargin bug on Android Chrome\n\t\t\tconst r = 1;//(document.body.classList.contains('android') && NS.BROWSER === 'chrome') ? window.devicePixelRatio : 1;\n\t\t\tconst rootMargin = (mt * r) + 'px ' + (os.marginRight * r) + 'px ' + (os.marginBottom * r) + 'px ' + (os.marginLeft * r) + 'px';\n\t\t\tconst io = new IntersectionObserver((es) => {\n\t\t\t\tconst vs = Array.from(prevVs);\n\t\t\t\tfor (let i = 0; i < es.length; i += 1) vs[ts.indexOf(es[i].target)] = es[i].isIntersecting;\n\t\t\t\tif (!isMatch(vs, prevVs)) fn(vs);\n\t\t\t\tprevVs = vs;\n\t\t\t}, { rootMargin: rootMargin, threshold: os.threshold });\n\t\t\tfor (let i = 0; i < ts.length; i += 1) io.observe(ts[i]);\n\t\t\treturn io;\n\t\t}\n\t\tlet prevVs = Array(ts.length).fill(false);\n\t\tlet mt = os.marginTop;\n\t\tif (mt !== 'OFFSET') {\n\t\t\tinit();\n\t\t\treturn;\n\t\t}\n\t\tlet io = null;\n\t\tlet st = null;\n\t\t// const off = NS.makeOffsetFunction(true, true);  // Initialize here\n\t\tonResize(() => {\n\t\t\tmt = 0;//-off();\n\t\t\tif (st) clearTimeout(st);\n\t\t\tst = setTimeout(() => {\n\t\t\t\tif (io) io.disconnect();\n\t\t\t\tio = init();\n\t\t\t}, 100);\n\t\t}, true);\n\t}\n\t\n\tfunction isMatch(vs0, vs1) {\n\t\tif (vs1.length !== vs0.length) return false;\n\t\tfor (let i = 0; i < vs0.length; i += 1) {\n\t\t\tif (vs0[i] !== vs1[i]) return false;\n\t\t}\n\t\treturn true;\n\t}\n\n})(window['NACSS']);\n"]}